---
title: "Tarea 3"
author: "Elisa Matte y Leandro Suárez"
format: html
editor: visual
---

## Selección de varibles 

Para la elección de variables en este caso, se seleccionó como dependiente la capacidad para controlar la preocupación hacia las difrentes situaciones de la vida y como independientes el sexo, la frecuencia de consumo y la satisfacción hacia la vida en general. El criterio de elección de estas variables se relaciona con la propuesta inicial del proyecto, el cual busca relacionar por medio de diferentes análisis, las coincidencias que se pueden presentar en torno a la frecuencia del consumo de alcohol y el estado de la salud mental de las personas. Este estado se intenta comprender a través de variables que responden como atributos a la construcción de esta compleja percepción, suscribiéndolos tanto a principios teóricos como a las dimensiones organizativas definidas por la propia encuesta seleccionada, la cual cuenta con una sección específica denominada: salud mental.

```{r}
pacman::p_load(dplyr, car, sjmisc, sjPlot, sjlabelled, stargazer, kableExtra, corrplot, texreg, ggplot2, ggpubr)
pacman::p_load(tidyverse,   # manipulacion datos.
               sjPlot,      # tablas.
               stargazer,   # tablas.
               confintr,    # IC.
               gginference, # visualizacion .
               rempsyc,     # reporte.
               broom,       # varios.
               sjmisc,      # para descriptivos .
               sjlabelled,  # etiquetas.
               knitr)

options(scipen = 999) # para desactivar notacion cientifica.

view(base$P102_2)
view(base$P6_1)
view(base$SEXO)
view(base$P77_1)

## Filtrar base de datos.
base_reg <- base %>% select(SEXO, 
                            P77_1,
                            P102_2,
                            P6_1)
view(base_reg)

# Cambiar el nombre de las variables.
base_reg <- base_reg %>% rename("consumo"=P77_1)
base_reg <- base_reg %>% rename("sexo"=SEXO)
base_reg <- base_reg %>% rename("preocupacion"=P102_2)
base_reg <- base_reg %>% rename("satisfaccion"=P6_1)

# Tratar 99 como casos perdidos (NA).
base_reg$consumo <- na_if(base_reg$consumo, 99)
base_reg$satisfaccion <- na_if(base_reg$satisfaccion, 99)
base_reg$satisfaccion <- na_if(base_reg$satisfaccion, 98)
base_reg$preocupacion <- na_if(base_reg$preocupacion, 99) 

view(base_reg)

# Tratar las variables como factor.
base_reg$consumo <- as.factor(base_reg$consumo)
base_reg$sexo <- as.factor(base_reg$sexo)
base_reg$preocupacion <- as.factor(base_reg$preocupacion)
base_reg$satisfaccion <- as.factor(base_reg$satisfaccion)

# Cambiar etiquetas de categorías de respuesta.
base_reg$sexo <- ifelse(base_reg$sexo == 1, "Hombre", ifelse(base_reg$sexo == 2, "Mujer", "Desconocido"))

base_reg$consumo <- car::recode(base_reg$consumo,
  "1 = 'Una vez al mes o menos';
   2 = 'Varias veces al mes';
   3 = 'Varias veces a la semana';
   4 = 'Varias veces al día'")

view(base_reg)
```

## Creación de modelos de regresión

Con la creación de estos modelos se busca conocer la relación que existe entre la variable sobre la capacidad de control de la preocupación de las personas según su sexo, su frecuencia de consumo y su sensación de satisfacción con la vida en general. De esta manera, se busca entender en qué medida la variable dependiente establece relación con las independientes, ¿se explican entre sí?

```{r}
reg1 <- lm(preocupacion ~ consumo, data=base_reg)
reg2 <- lm(preocupacion ~ sexo, data=base_reg)
reg3 <- lm(preocupacion ~ satisfaccion, data=base_reg)

knitreg(list(reg1, reg2, reg3), 
        custom.model.names = c("Modelo 1",
                               "Modelo 2",
                               "Modelo 3"),
        custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
        custom.coef.names = c("Intercepto", 
                              "consumo",
                              "satisfaccion", 
                              "sexo"),
        caption = "preocupacion",
        caption.above = TRUE)
```

```{r}
graph1 <- ggplot(base_reg, aes(x = satisfaccion, y = preocupacion)) +
  geom_point(size = 1) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Satisfaccion", y = "Preocupacion")
```

The `echo: false` option disables the printing of code (only output is displayed).
